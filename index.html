<style>
    /* Tooltip Styling */
    .tooltip {
        display: none;
        position: absolute;
        background: rgba(0, 0, 0, 0.85);
        color: white;
        padding: 8px;
        border-radius: 5px;
        font-size: 14px;
        white-space: pre-line;  /* Enables multi-line formatting */
        text-align: left;
    }
    td {
        position: relative;
    }
    td:hover .tooltip {
        display: block;
        position: absolute;
        top: 100%;
        left: 50%;
        transform: translateX(-50%);
        width: max-content;
        max-width: 300px;
        z-index: 10;
    }
</style>

<script>
    fetch('compliance-report.json')
        .then(response => response.json())
        .then(data => {
            let tableBody = document.getElementById('compliance-data');
            let lastUpdated = document.getElementById('last-updated');
            let severityCounts = { "Critical": 0, "High": 0, "Medium": 0, "Low": 0 };

            tableBody.innerHTML = "";
            data.findings.forEach(finding => {
                let severityClass = finding.severity.toLowerCase().replace(" ", "-");
                severityCounts[finding.severity]++;

                let row = `<tr>
                    <td>${finding.title}</td>
                    <td class="${severityClass}">${finding.severity}</td>
                    <td>${finding.service}</td>
                    <td>
                        ${finding.compliance_standard}
                        <span class="tooltip">${finding.full_compliance_standards}</span>
                    </td>
                    <td>${finding.remediation_time}</td>
                </tr>`;
                tableBody.innerHTML += row;
            });

            lastUpdated.textContent = new Date().toLocaleString();
        });
</script>
